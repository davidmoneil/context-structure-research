---
type: claude-knowledge
source: aiprojects
source_path: ".claude/agent-output/results/upgrade-discovery-2026-02-15-critical.md"
source_category: "discovery"
synced: 2026-02-17
title: "Upgrade Discovery Report - CRITICAL UPDATE"
tags:
  - claude-knowledge
  - discovery
---

# Upgrade Discovery Report - CRITICAL UPDATE
**Date**: 2026-02-15 06:12 MST
**Session**: headless-upgrade-discover-20260215-061001
**Analyst**: Claude Headless Analyst
**Update**: Third execution - CRITICAL security finding

---

## ðŸš¨ CRITICAL SECURITY ALERT ðŸš¨

### UP-044: MCP Git Server RCE Vulnerabilities

**Severity**: CRITICAL
**Impact**: Remote Code Execution via Prompt Injection
**Action Required**: IMMEDIATE VERSION VERIFICATION

#### Vulnerability Summary

Three critical RCE vulnerabilities discovered in Anthropic's `mcp-server-git`:

| CVE | Severity | Description |
|-----|----------|-------------|
| CVE-2025-68143 | HIGH | Unrestricted `git_init` - creates Git repositories without validation |
| CVE-2025-68144 | HIGH | Argument injection in `git_diff`/`git_checkout` - file overwrites/deletion |
| CVE-2025-68145 | **CRITICAL** | Path validation bypass - access any repository on system |

#### Attack Vector

**Prompt Injection**: Malicious README file, issue description, or webpage content can weaponize these vulnerabilities **without any direct access to the victim's system**.

**Chain Potential**: Can be combined with Filesystem MCP server to achieve full remote code execution.

#### Affected Systems

- **AIProjects Current State**: Git MCP v2024.1 (last checked 2026-01-20)
- **Vulnerable Versions**: `< 2025.9.25` and `< 2025.12.18`
- **Patched Versions**: `2025.9.25`, `2025.12.18`

#### Immediate Action Required

```bash
# 1. Check MCP Git server version
cat ~/.claude/config.json | jq '.mcpServers["git"]'

# 2. Check running process
ps aux | grep mcp-server-git

# 3. If version < 2025.12.18: UPGRADE IMMEDIATELY
npm update @modelcontextprotocol/server-git
# OR
# Update MCP server via Claude Code: claude mcp update git
```

#### Remediation Applied (by Anthropic)

1. **Removed**: `git_init` tool entirely from package
2. **Added**: Extra validation to prevent path traversal primitives

#### Next Steps

1. âœ… **Verify** current Git MCP server version
2. âš ï¸ **Upgrade** if vulnerable (< 2025.12.18)
3. âš ï¸ **Review** prompt injection attack surface:
   - External content processing (README files, web scraping)
   - Git repository sources (public repos, issue trackers)
   - MCP security boundaries (Filesystem + Git combination)
4. âš ï¸ **Document** mitigation in `.claude/context/integrations/mcp-security.md`
5. âš ï¸ **Audit** all 7 active MCP servers for similar vulnerabilities

#### Sources

- [The Hacker News - Three Flaws in Anthropic MCP Git Server](https://thehackernews.com/2026/01/three-flaws-in-anthropic-mcp-git-server.html)
- [The Register - Anthropic Quietly Fixed Flaws](https://www.theregister.com/2026/01/20/anthropic_prompt_injection_flaws/)
- [Blueinfy Blog - AI Vulnerabilities](https://blog.blueinfy.com/2026/01/ai-vulnerabilities-mcp-git-serve.html)
- [GitHub Advisory GHSA-3q26-f695-pp76](https://github.com/advisories/GHSA-3q26-f695-pp76)

---

## Other Discoveries (Non-Critical)

### UP-042: Claude Code v2.1.40 - Auth CLI & Resume Improvements
**Published**: 2026-02-13
**Severity**: Medium
**Type**: Feature + Bugfix

**Key Features**:
- `claude auth login/status/logout` CLI subcommands
- Windows ARM64 native binary support
- `/rename` auto-generates session names from context
- Fixed @-mentions with anchor fragments
- Fixed FileReadTool blocking on FIFOs/stdin/large files
- AWS auth refresh timeout (3 minutes)

**Recommendation**: AUTO-UPGRADE

---

### UP-043: Claude Code v2.1.41-2.1.42 - Performance & UX
**Published**: 2026-02-13 (v2.1.42 is latest)
**Severity**: Low-Medium
**Type**: Bugfix + Performance

**Key Changes**:
- Startup performance improvements (deferred Zod schema construction)
- Better prompt cache hit rates
- Fixed /resume showing interrupt messages
- Improved image error messaging

**Recommendation**: AUTO-UPGRADE

---

## Recommended Beads Tasks

Since Beads CLI is not available in headless context, create these tasks manually:

### Task 1: CRITICAL - MCP Git Server Security
```bash
bd create "CRITICAL: Verify MCP Git Server version and patch RCE vulnerabilities" -t task -p 0 \
  -l "domain:infrastructure,project:aiprojects,severity:critical,source:headless" \
  -d "Discovered via headless upgrade-discover on 2026-02-15. Three RCE vulnerabilities (CVE-2025-68143/68144/68145) in Anthropic's MCP Git Server. Current version v2024.1 may be vulnerable. Patched versions: 2025.9.25, 2025.12.18. IMMEDIATE ACTION: Check version, upgrade if needed, review security boundaries. See UP-044."
```

### Task 2: Upgrade Claude Code
```bash
bd create "Upgrade: Claude Code to v2.1.42" -t task -p 2 \
  -l "domain:infrastructure,project:aiprojects,severity:medium,source:headless" \
  -d "Discovered via headless upgrade-discover on 2026-02-15. Latest stable release with auth CLI, performance improvements, and resume fixes. See UP-042, UP-043."
```

---

## Data Files Updated

1. **pending-upgrades.json**: Added UP-042, UP-043, UP-044 (3 new entries, total 44)
2. **baselines.json**: Updated last_checked timestamps and security notes

---

## Summary

| Metric | Value |
|--------|-------|
| **Total Discoveries** | 3 |
| **CRITICAL Issues** | 1 (MCP Git Server RCE) |
| **Claude Code Updates** | 2 (v2.1.40-v2.1.42) |
| **Immediate Action Required** | YES - Verify MCP Git version |

**Report Generated**: 2026-02-15 06:12:23 MST
**Next Discovery Run**: 2026-02-22 06:00 MST
